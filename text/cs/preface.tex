\pagestyle{plain}
\setcounter{page}{1}

\chapter{Úvod}
Hlavní motivací pro výběr této práce byl vysoký nárůst v~poptávce na strojové zpracování dat, kde je velký důraz kladen na rychlost a~efektivitu výpočtu. Často se zde setkáváme s~protichůdnými požadavky na krátkou dobu výpočtu a~zpracování velkého množství dat.
Pokud pro takovéto úlohy využijeme moderní počítačové čipy podporující paralelní výpočty, můžeme výpočet urychlit rozdělením úlohy na menší nezávislé části, které pak lze řešit najednou. Hlavním problémem je právě toto rozdělení dat, protože neexistuje obecný způsob jeho provedení. Různé algoritmy totiž vyžadují jiné rozdělení dat a~mnohdy závisí i~na vlastnostech dat samotných. Tuto problematiku je tedy nutné prozkoumat detailněji.\\

V~této práci se zaměříme na možnosti zlepšení shlukové analýzy pomocí efektivní implementace, přičemž budeme klást důraz na maximální využití paralelních architektur, jako jsou například vícejádrové počítačové (CPU) a~grafické (GPU) čipy. Budeme se zabývat především různými přístupy k~paralelizaci algoritmu a~závislosti na vlastnostech vstupních dat.
Data se od sebe velice liší, protože pochází z~mnoha různých zdrojů, jako jsou například sociální sítě, finanční burzy, lékařství, astronomie a~mnoho dalších. Všechna však obsahují velmi užitečná data pro vědce, sociology, lékaře, ale i~pro analytiky, makléře a~například i~pro cílenou reklamu.
Pokud se nám podaří urychlit shlukovou analýzu paralelizací výpočtu, budeme moci řešit problémy mnohem rychleji, což je pro některé odvětví zásadní. Naše řešení může dokonce dovolit využití shlukové analýzy i~v~odvětvích, ve kterých byla dříve nepoužitelná ať už kvůli rychlosti výpočtu a~nebo velkému objemu dat.\\

Protože shluková analýza lze řešit mnoha různými přístupy, musíme si vybrat jeden konkrétní algoritmus, který budeme následně analyzovat. Pro tuto práci jsme zvolil algoritmus k-means a~to především pro jeho široké využití, nízkou složitost a~dobře známé matematické vlastnosti. Také jde o~jeden z~nejefektivnějších shlukových algoritmů zmiňovaných v~literatuře~\cite{Aggarwal13}.\\

Algoritmus k-means můžeme definovat následovně: Vstupem je množina bodů a~počet shluků $k$. Úkolem algoritmu je seskupit body do nepřekrývajících se shluků. Každý takový shluk navíc obsahuje speciální bod zvaný centroid, který je zkonstruován jako průměr ze všech bodů, kterým je mezi centroidy nejblíže. K~výpočtu vzdálenosti lze použít datům odpovídající metriku, nejčastěji se však využívá Eukleidovská vzdálenost~\cite{Zechner09} pro její univerzálnost. Optimální množinu centroidů lze nalézt tak, že se snažíme minimalizovat součet vzdáleností mezi jednotlivými body a~středem daného shluku, který je reprezentován právě nejbližším centroidem. Je dokázáno, že vyřešit tento problém je NP-těžké už pro 2 shluky~\cite{Drineas04}. Algoritmus k-means optimální řešení pouze aproximuje postupnou konvergencí k~lokálnímu minimu, které závisí na volbě počátečních centroidů.\\

Prvním krokem algoritmu k-means je výběr $k$ bodů, které poslouží jako počáteční centroidy. Velmi často se k~tomuto účelu volí náhodné body ze vstupní množiny. V~dalším kroku je pak každý bod přiřazen k~nejbližšímu centroidu. Poté se pro nově vzniklé shluky spočítá nový centroid jako průměr obsažených bodů. Algoritmus pracuje iterativně opakováním těchto dvou kroků, dokud se centroidy neustálí (nezmění se mezi dvěma iteracemi) a~nebo pokud není dosaženo předem určeného počtu iterací.\\

Protože je algoritmus tvořen mnoha datově paralelními úlohami, je dobré použít výpočetní prostředky, které jsou schopny této vlastnosti využít.
Dobrým kandidátem pro paralelizaci k-means jsou grafické karty~\cite{Zechner09} jakožto relativně levné, masivně paralelní procesory. Obsahují tisíce jednoduchých jader, které jsou schopné počítat základní matematické operace. I~přesto, že jejich hlavním zaměřením jsou primárně grafické úlohy, jsou tyto karty schopné poskytnout svůj výpočetní výkon i~pro obecné úlohy (General-purpose computing on graphics processing units - GPGPU). Pokud se nám tedy podaří využít potenciálu grafických karet a~zároveň datového paralelismu v~algoritmu k-means k~rovnoměrnému rozdělení výpočtů mezi jednotlivá výpočetní jádra GPU, budeme schopni výpočet mnohonásobně zrychlit.\\

Paralelizace algoritmu k-means ale přináší i~úskalí, která je potřeba vyřešit. Algoritmus musí být optimalizován pro masivně paralelní prostředí. To především znamená, že musíme být schopni jednotlivé úkoly rovnoměrně rozdělit mezi tisíce výpočetních jader a~postarat se o~jejich efektivní využití. Pokud by se nám nepodařilo zapojit všechna dostupná jádra, ztratili bychom odpovídající množství výkonu, což je samozřejmě nežádoucí. Další výzvou je pak co nejefektivnější využití paměťového modelu grafických karet, protože špatné používání paměti, jako na\-pří\-klad časté přístupy k~nejpomalejším pamětím, mohou výkon algoritmu rapidně snížit.\\

V~roce 2009 již zkoumal využití grafických karet pro algoritmus k-means Hong-Tao Bai s~jeho týmem~\cite{Hong09}, ale tato práce byla spíše konceptem a~neprozkoumala detailní možnosti paralelizace.
V~naší práci se budeme soustředit na vlastnosti vstupních dat a~jejich vliv na výkonnost algoritmu při odlišných přístupech k~paralelizaci. Tento vztah je pro k-means rozhodující, protože právě vstupní data velice ovlivňují výpočet algoritmu a~tím pádem i~jeho efektivitu.
Dalším důvodem je pak velice rychlý vývoj technologií, tedy i~grafických karet. Ty se od roku 2009 v~mnohém posunuly kupředu, takže bychom se chtěli zaměřit i~na výkon jednotlivých generací karet.\\

\hyperref[sec:clusteranalysis]{Kapitola~\ref*{sec:clusteranalysis}} obsahuje úvod do shlukové analýzy, různé druhy modelů shluků a~shlukových algoritmů. \hyperref[sec:gpgpu]{Kapitola~\ref*{sec:gpgpu}} se zabývá GPGPU, CUDA frameworkem a~jeho analýzou. \hyperref[sec:implementation]{Kapitola~\ref*{sec:implementation}} obsahuje popis a~analýzu naší implementace a~paralelizačních metod. V~\hyperref[sec:results]{kapitole~\ref*{sec:results}} je pak rozbor dosažených výsledků této práce a~efektivity paralelizace k-means.